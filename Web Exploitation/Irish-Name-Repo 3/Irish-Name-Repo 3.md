# Overview
`Medium` `Web Exploitation` `picoCTF 2019`

# Description
There is a secure website running at https://jupiter.challenges.picoctf.org/problem/40742/ or http://jupiter.challenges.picoctf.org:40742. 

Try to see if you can login as admin!

# Hints
Seems like the password is encrypted

# Solution
We are presented with the same website as Irish Name Repo 1 & 2.

First thing I noticed with the login screen is there is now only a password box

Therefore we can try using a simple SQL injection `' or 1=1--`. When doing so we get a HTTP 500 error:

<kbd>![Screenshot](https://github.com/user-attachments/assets/8c377cb7-5213-45d9-9649-89e9d97d767a)</kbd>

Using `ctrl` + `shift` + `i` to inspect, we can notice that there is more than one input, one of them hidden and set to 0.

<kbd>![Screenshot](https://github.com/user-attachments/assets/c7028284-de2d-4c90-a63f-9c1f15b66966)</kbd>

If we set this to 1, we can actually see the query we are inputting after the encryption that messes up our injections occurs.

<kbd>![Screenshot](https://github.com/user-attachments/assets/965409fc-4d9d-4617-a335-aaf5b6c457d0)</kbd>

Now enter the same SQL query from before and you will see we are presented with the query:

```
password: ' or 1=1--
SQL query: SELECT * FROM admin where password = '' be 1=1--'
```

For curiosity, let's add every letter after the comment to see what the encryption is doing (keeping the value set to 1):

```
password: ' or 1=1--abcdefghijklmnopqrstuvwxyz
SQL query: SELECT * FROM admin where password = '' be 1=1--nopqrstuvwxyzabcdefghijklm'
```

We can see that values are replaced (e.g. "a" and "d" are replaced by "n" and "q"). This is known as a Caesar cipher (shift cipher)

Trying `' be 1=1--` as the password, we get through the portal to see the flag:

<kbd>![Screenshot](https://github.com/user-attachments/assets/94d34768-bc4e-4ba9-903b-6a6e8dfcf320)</kbd>


# Flag
`picoCTF{3v3n_m0r3_SQL_4424e7af}`
