# Overview
`Medium` `Web Exploitation` `picoCTF 2019`

# Description
Check the admin scratchpad! `https://jupiter.challenges.picoctf.org/problem/63090`/ or http://jupiter.challenges.picoctf.org:63090

# Hints
- What is that cookie?
- Have you heard of JWT?

# Solution
When we enter this link, we are presented with a scratchpad web app of some type. It lets us through for any user besides "admin". 

Let's trying using a random username such as "user"

When it does let us through, a cookie pops up in the Application tab of Chrome Developer tools called "jwt":

<kbd>![image](https://github.com/user-attachments/assets/b76bfd4f-22c6-4a48-9738-fefbfbbe22a1)</kbd>

One of the hints says "Have you heard of JWT?"
If you don't know anything about JWTs, let me explain. 

>[!NOTE]
> JSON Web Token which is an open standard that allows secure communication between two parties.
> This token is comprised of three components: the header, the payload, and the signature.
> A JWT is commonly used for authentication and authorization

A useful tool to use here is [jwt.io](https://jwt.io/). This online tool decodes the JWT into the three components.

Let's copy the JWT from the Application tab and paste it into jwt.io:

<kbd>![image](https://github.com/user-attachments/assets/31d38ac2-2fa6-4165-af7e-b3c57635a3ac)</kbd>


Decoding the JWT cookie show that this JWT uses the HS256 algorithm. 
The payload is just one value: the username we entered. We know that the correct username is "admin", as that is who the website does not let log in, but we don't know the signature. 

From here, we need to use JohnTheRipper. 

[JohnTheRipper](https://github.com/openwall/john) is an Open Source password security auditing and password recovery tool available for many operating systems. 
This uses a brute force method which is very slow, as it has to go through so many possibilities. 

The best way to use JohnTheRipper is with a word list. A word list is essentially a dictionary of commonly used secrets to narrow down the possibilities. 
This could mean the difference between several hours and mere few seconds. A very strong word list is [rockyou](https://github.com/brannondorsey/naive-hashcat/releases/download/data/rockyou.txt), which has a massive collection of common words. 

After running this, JohnTheRipper gets you the secret: `ilovepico`

Go back to jwt.io and put the secret into the secret key and change the user in the payload to "admin"

<kbd>![image](https://github.com/user-attachments/assets/0193db05-f9f4-48bb-815d-9dd0a6617605)</kbd>

Copy this as your jwt cookie, enter this cookie using the Application tab, and then refresh the page. 

<kbd>![image](https://github.com/user-attachments/assets/e1b7c500-4fae-4fb8-8b06-a9c5a62f8717)</kbd>

This bypasses the portal and shows us the flag.

<kbd>![Screenshot](https://github.com/user-attachments/assets/34a6973b-62c6-4126-81a0-3f997cce0acb)</kbd>

# Flag
`picoCTF{jawt_was_just_what_you_thought_f859ab2f}`
